var t={d:(a,e)=>{for(var n in e)t.o(e,n)&&!t.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:e[n]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)},a={};t.d(a,{U:()=>T});const e=20,n=52,o="yellow",r=["red","pink","cyan","orange"],s=[34,139,34],i="#ececef",c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l={contributions:[],pacman:{x:0,y:0,direction:"right",points:0,powerUp:!1},ghosts:[],grid:[],monthLabels:[],pacmanMouthOpen:!0,gameInterval:0,scaredGhostsDestinations:[],gameHistory:[],canvas:void 0,outputFormat:"canvas",svgCallback:t=>{},gameOverCallback:()=>{}},m=()=>{l.canvas.getContext("2d").clearRect(0,0,l.canvas.width,l.canvas.height);for(let t=0;t<7;t++)for(let a=0;a<n;a++){const n=l.grid[t][a];if(n>0){const t=`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${n<.2?.3:n})`;l.canvas.getContext("2d").fillStyle=t}else l.canvas.getContext("2d").fillStyle=i;l.canvas.getContext("2d").beginPath(),l.canvas.getContext("2d").roundRect(22*a,22*t+15,e,e,5),l.canvas.getContext("2d").fill()}l.canvas.getContext("2d").fillStyle="black",l.canvas.getContext("2d").font="10px Arial",l.canvas.getContext("2d").textAlign="center";let t="";for(let a=0;a<n;a++)if(l.monthLabels[a]!==t){const e=22*a+10;l.canvas.getContext("2d").fillText(l.monthLabels[a],e,10),t=l.monthLabels[a]}},g=()=>{const t=22*l.pacman.y+10,a=22*l.pacman.x+10+15;l.canvas.getContext("2d").fillStyle=l.pacman.powerUp?"red":o;const e=l.pacmanMouthOpen?.25*Math.PI:.1*Math.PI;let n,r;switch(l.pacman.direction){case"up":n=1.5*Math.PI+e,r=1.5*Math.PI-e;break;case"down":n=.5*Math.PI+e,r=.5*Math.PI-e;break;case"left":n=Math.PI+e,r=Math.PI-e;break;default:n=0+e,r=2*Math.PI-e}l.canvas.getContext("2d").beginPath(),l.canvas.getContext("2d").arc(t,a,10,n,r),l.canvas.getContext("2d").lineTo(t,a),l.canvas.getContext("2d").fill()},h=()=>{l.ghosts.forEach((t=>{const a=22*t.y+10,e=22*t.x+10+15,n=10;l.canvas.getContext("2d").fillStyle=t.scared?"blue":t.color,l.canvas.getContext("2d").beginPath(),l.canvas.getContext("2d").arc(a,e,n,0,Math.PI),l.canvas.getContext("2d").rect(a-n,e,20,n),l.canvas.getContext("2d").fill(),l.canvas.getContext("2d").fillStyle="white",l.canvas.getContext("2d").beginPath(),l.canvas.getContext("2d").arc(a-n/3,e-n/3,2.5,0,2*Math.PI),l.canvas.getContext("2d").arc(a+n/3,e-n/3,2.5,0,2*Math.PI),l.canvas.getContext("2d").fill(),l.canvas.getContext("2d").fillStyle="black",l.canvas.getContext("2d").beginPath(),l.canvas.getContext("2d").arc(a-n/3,e-n/3,1.25,0,2*Math.PI),l.canvas.getContext("2d").arc(a+n/3,e-n/3,1.25,0,2*Math.PI),l.canvas.getContext("2d").fill()}))},u=t=>{const a=10,e=t,n=2*Math.PI-t;return`M 10,10\n            L ${a+a*Math.cos(e)},${a+a*Math.sin(e)}\n            A 10,10 0 1,1 ${a+a*Math.cos(n)},${a+a*Math.sin(n)}\n            Z`},d=()=>l.gameHistory.map(((t,a)=>a/(l.gameHistory.length-1))).join(";"),p=(t,a)=>l.gameHistory.map((e=>{const n=e.grid[t][a];return n>0?f(n):i})).join(";"),f=t=>`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${t<.2?.3:t})`,v=t=>l.gameHistory.map((a=>{const e=a.ghosts[t];return`${22*e.y},${22*e.x+15}`})).join(";"),y=()=>{if("svg"==l.outputFormat){const t=()=>l.grid.some((t=>t.some((t=>t>0))));for(;t();)x();x()}else clearInterval(l.gameInterval),l.gameInterval=setInterval((()=>x()),200)},x=()=>{if(l.grid.some((t=>t.some((t=>t>0)))))$(),b(),C(),l.pacmanMouthOpen=!l.pacmanMouthOpen,l.gameHistory.push({pacman:Object.assign({},l.pacman),ghosts:l.ghosts.map((t=>Object.assign({},t))),grid:l.grid.map((t=>[...t]))}),"canvas"==l.outputFormat&&m(),"canvas"==l.outputFormat&&g(),"canvas"==l.outputFormat&&h();else{if("canvas"==l.outputFormat&&(clearInterval(l.gameInterval),"canvas"==l.outputFormat&&(l.canvas.getContext("2d").fillStyle="black",l.canvas.getContext("2d").font="20px Arial",l.canvas.getContext("2d").textAlign="center",l.canvas.getContext("2d").fillText("Game Over",l.canvas.width/2,l.canvas.height/2))),"svg"==l.outputFormat){const t=(()=>{let t='<svg width="1144" height="174" xmlns="http://www.w3.org/2000/svg">',a="";for(let e=0;e<n;e++)l.monthLabels[e]!==a&&(t+=`<text x="${22*e+10}" y="10" text-anchor="middle" font-size="10" fill="black">${l.monthLabels[e]}</text>`,a=l.monthLabels[e]);for(let a=0;a<7;a++)for(let e=0;e<n;e++){const n=22*e,o=22*a+15,r=l.gameHistory[0].grid[a][e],s=r>0?f(r):i;t+=`<rect id="cell-${a}-${e}" x="${n}" y="${o}" width="20" height="20" rx="5" fill="${s}">\n                <animate attributeName="fill" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite" \n                    values="${p(a,e)}" \n                    keyTimes="${d()}"/>\n            </rect>`}return t+=`<path id="pacman" fill="${o}" d="${u(.25)}"\n        transform="translate(${22*l.pacman.y}, ${22*l.pacman.x+15})">\n        <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n            keyTimes="${d()}"\n            values="${l.gameHistory.map((t=>`${22*t.pacman.y},${22*t.pacman.x+15}`)).join(";")}"/>\n        <animate attributeName="d" dur="0.2s" repeatCount="indefinite"\n            values="${u(.25)};${u(.05)};${u(.25)}"/>\n    </path>`,l.ghosts.forEach(((a,n)=>{var o,r;t+=`<path id="ghost${n}" d="${r=10,`M ${r},${2*r}\n            Q ${.8*r},${1.5*r} ${.5*r},${1.3*r}\n            Q ${.3*r},${1.1*r} 0,${r}\n            L 0,0\n            L ${2*r},0\n            L ${2*r},${r}\n            Q ${1.7*r},${1.1*r} ${1.5*r},${1.3*r}\n            Q ${1.2*r},${1.5*r} ${r},${2*r}\n            Z`}" fill="${a.color}">\n            <animate attributeName="fill" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${o=n,l.gameHistory.map((t=>{const a=t.ghosts[o];return a.scared?"blue":a.color})).join(";")}"/>\n            <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${v(n)}"/>\n        </path>\n        <circle cx="${e/3}" cy="${e/3}" r="2.5" fill="white">\n            <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${v(n)}"/>\n        </circle>\n        <circle cx="${40/3}" cy="${e/3}" r="2.5" fill="white">\n            <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${v(n)}"/>\n        </circle>\n        <circle cx="${e/3}" cy="${e/3}" r="1.25" fill="black">\n            <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${v(n)}"/>\n        </circle>\n        <circle cx="${40/3}" cy="${e/3}" r="1.25" fill="black">\n            <animateTransform attributeName="transform" type="translate" dur="${300*l.gameHistory.length}ms" repeatCount="indefinite"\n                keyTimes="${d()}"\n                values="${v(n)}"/>\n        </circle>`})),t+="</svg>",t})(),a=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),r=URL.createObjectURL(a);l.svgCallback(r)}l.gameOverCallback()}},$=()=>{let t=[];if(l.pacman.powerUp)t=l.ghosts.map((t=>({x:t.x,y:t.y,distance:1/0})));else for(let a=0;a<7;a++)for(let e=0;e<n;e++)l.grid[a][e]>0&&t.push({x:a,y:e,distance:1/0});if(0===t.length)return;const a=t.reduce(((t,a)=>{const e=Math.abs(a.x-l.pacman.x)+Math.abs(a.y-l.pacman.y);return e<t.distance?Object.assign(Object.assign({},a),{distance:e}):t}),{x:l.pacman.x,y:l.pacman.y,distance:1/0}),e=a.x-l.pacman.x,o=a.y-l.pacman.y;Math.abs(e)>Math.abs(o)?(l.pacman.x+=Math.sign(e),l.pacman.direction=e>0?"down":"up"):(l.pacman.y+=Math.sign(o),l.pacman.direction=o>0?"right":"left"),l.grid[l.pacman.x][l.pacman.y]>0&&(l.pacman.points+=1,l.grid[l.pacman.x][l.pacman.y]=0,l.pacman.points>=30&&P())},b=()=>{l.ghosts.forEach(((t,a)=>{if(t.scared){t.target||(t.target=M(t.x,t.y));const a=t.target.x-t.x,e=t.target.y-t.y,o=Math.abs(a)>Math.abs(e)?Math.sign(a):0,r=Math.abs(e)>=Math.abs(a)?Math.sign(e):0,s=t.x+o,i=t.y+r;s>=0&&s<7&&i>=0&&i<n&&(t.x=s,t.y=i),t.x===t.target.x&&t.y===t.target.y&&(t.target=M(t.x,t.y))}else{const a=[[-1,0],[1,0],[0,-1],[0,1]],[e,o]=a[Math.floor(Math.random()*a.length)];if(l.pacman.powerUp&&Math.random()<.5)return;const r=t.x+e,s=t.y+o;r>=0&&r<7&&s>=0&&s<n&&(t.x=r,t.y=s)}}))},M=(t,a)=>{const e=t+Math.floor(21*Math.random())-10,n=a+Math.floor(21*Math.random())-10;return{x:Math.max(0,Math.min(e,6)),y:Math.max(0,Math.min(n,51))}},C=()=>{l.ghosts.forEach(((t,a)=>{t.x===l.pacman.x&&t.y===l.pacman.y&&(l.pacman.powerUp&&t.scared?(w(a),l.pacman.points+=10,"canvas"==l.outputFormat&&setTimeout((()=>{k(),y()}),5e3)):"canvas"==l.outputFormat?(clearInterval(l.gameInterval),setTimeout((()=>{k(),y()}),5e3)):k())}))},w=t=>{let a,e;do{a=Math.floor(7*Math.random()),e=Math.floor(Math.random()*n)}while(Math.abs(a-l.pacman.x)<=2&&Math.abs(e-l.pacman.y)<=2||0===l.grid[a][e]);l.ghosts[t]={x:a,y:e,color:r[t%r.length],scared:!1,target:void 0}},k=()=>{let t=[];for(let a=0;a<7;a++)for(let e=0;e<n;e++)l.grid[a][e]>0&&t.push({x:a,y:e});if(t.length>0){const a=t[Math.floor(Math.random()*t.length)];l.pacman={x:a.x,y:a.y,direction:"right",points:0,powerUp:!1}}l.ghosts.forEach((t=>t.scared=!1)),"canvas"==l.outputFormat&&m(),"canvas"==l.outputFormat&&g(),"canvas"==l.outputFormat&&h()},P=()=>{l.pacman.powerUp=!0,l.ghosts.forEach((t=>t.scared=!0)),setTimeout((()=>{l.pacman.powerUp=!1,l.ghosts.forEach((t=>t.scared=!1)),l.pacman.points=0}),5e3)};var I=function(t,a,e,n){return new(e||(e=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function i(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var a;t.done?o(t.value):(a=t.value,a instanceof e?a:new e((function(t){t(a)}))).then(s,i)}c((n=n.apply(t,a||[])).next())}))};const T=t=>{return a=void 0,e=void 0,s=function*(){var a;"gitlab"==t.platform?l.contributions=yield(a=t.username,I(void 0,void 0,void 0,(function*(){const t=yield fetch(`https://gitlab.com/users/${a}/calendar.json`),e=yield t.json();return Object.entries(e).map((([t,a])=>({date:new Date(t),count:Number(a)})))}))):l.contributions=yield((t,a)=>I(void 0,void 0,void 0,(function*(){const e={login:t},n=yield fetch("https://api.github.com/graphql",{headers:{Authorization:`bearer ${a}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify({variables:e,query:"\n    query ($login: String!) {\n      user(login: $login) {\n        contributionsCollection {\n          contributionCalendar {\n            weeks {\n              contributionDays {\n                contributionCount\n                contributionLevel\n                weekday\n                date\n              }\n            }\n          }\n        }\n      }\n    }\n  "})});return(yield n.json()).data.user.contributionsCollection.contributionCalendar.weeks.map((t=>t.contributionDays)).flat().map((t=>({date:t.date,count:t.contributionCount})))})))(t.username,t.githubAuthToken),t.output&&(l.outputFormat=t.output),l.svgCallback=t.svgCallback,l.gameOverCallback=t.gameOverCallback,"canvas"==t.output&&(l.canvas=t.canvas,l.canvas.width=1144,l.canvas.height=174),(()=>{l.grid=Array.from({length:7},(()=>Array.from({length:n},(()=>0)))),l.monthLabels=Array(n).fill("");let t=1;const a=new Date,e=new Date(a);e.setDate(a.getDate()-a.getDay()),l.contributions.forEach((a=>{const o=new Date(a.date),r=o.getDay(),s=Math.floor((+e-+o)/6048e5);s>=0&&s<n&&r>=0&&r<7&&(l.grid[r][51-s]=a.count,a.count>t&&(t=a.count))}));for(let a=0;a<7;a++)for(let e=0;e<n;e++)l.grid[a][e]>0&&(l.grid[a][e]=l.grid[a][e]/t);for(let t=0;t<n;t++){const a=51-t,n=new Date(e);n.setDate(n.getDate()-7*a),l.monthLabels[t]=c[n.getMonth()]}})(),"canvas"==t.output&&m(),(()=>{let t=[];for(let a=0;a<7;a++)for(let e=0;e<n;e++)l.grid[a][e]>0&&t.push({x:a,y:e});if(t.length>0){const a=t[Math.floor(Math.random()*t.length)];l.pacman={x:a.x,y:a.y,direction:"right",points:0,powerUp:!1}}"canvas"==l.outputFormat&&g()})(),(()=>{l.ghosts=[],l.scaredGhostsDestinations=[];for(let t=0;t<4;t++){const a=r[t%r.length];let e,o;do{e=Math.floor(7*Math.random()),o=Math.floor(Math.random()*n)}while(0===l.grid[e][o]);l.ghosts.push({x:e,y:o,color:a,scared:!1,target:void 0}),l.scaredGhostsDestinations.push({x:0,y:0})}"canvas"==l.outputFormat&&h()})(),y()},new((o=void 0)||(o=Promise))((function(t,n){function r(t){try{c(s.next(t))}catch(t){n(t)}}function i(t){try{c(s.throw(t))}catch(t){n(t)}}function c(a){var e;a.done?t(a.value):(e=a.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,i)}c((s=s.apply(a,e||[])).next())}));var a,e,o,s};var O=a.U;export{O as renderContributions};