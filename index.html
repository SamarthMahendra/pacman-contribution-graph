<!doctype html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="google-site-verification" content="ETILrgmBZ33RjlxJh-ybUFcIlIyKXyefMvxbxC6LmOU" />
		<title>GitLab Contributions Pac-Man</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
		<style>
			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				line-height: 1.6;
				color: #333;
				padding-top: 60px;
			}
			.navbar {
				background-color: #24292e;
			}
			.navbar-brand,
			.nav-link {
				color: #ffffff !important;
			}
			.jumbotron {
				background-color: #f6f8fa;
				padding: 2rem;
				margin-bottom: 2rem;
			}
			#canvas,
			#svgholder {
				max-width: 100%;
				height: auto;
			}
			.section {
				margin-bottom: 3rem;
			}
			pre {
				background-color: #f6f8fa;
				border: 1px solid #e1e4e8;
				border-radius: 6px;
				padding: 16px;
				overflow: auto;
			}
		</style>
	</head>
	<body>
		<nav class="navbar navbar-expand-lg fixed-top">
			<div class="container">
				<a class="navbar-brand" href="#">Pac-Man Contributions</a>
				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarNav"
					aria-controls="navbarNav"
					aria-expanded="false"
					aria-label="Toggle navigation"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a class="nav-link" href="https://abozanona.github.io/pacman-contribution-graph/" target="_blank"
								><i class="fab fa-github"></i> GitHub</a
							>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://buymeacoffee.com/abozanona/" target="_blank"
								><i class="fas fa-coffee"></i> Buy Me a Coffee</a
							>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://abozanona.me/pacman-contribution-graph/" target="_blank"
								><i class="fas fa-blog"></i> Blog</a
							>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<div class="container">
			<div class="jumbotron">
				<h1 class="display-4">GitLab Contributions Pac-Man</h1>
				<p class="lead">Turn your GitHub or GitLab contributions into an interactive Pac-Man game!</p>
				<hr class="my-4" />
				<p>
					This project allows you to visualize your contribution graph as a playable Pac-Man game. Set up your preferences,
					generate the game, and have fun while showcasing your coding activity.
				</p>
			</div>

			<div class="section">
				<h2>Game Configuration</h2>
				<div class="row">
					<div class="col-md-6">
						<div class="mb-3">
							<label for="platform" class="form-label">Platform</label>
							<select id="platform" class="form-select">
								<option value="github">GitHub</option>
								<option value="gitlab">GitLab</option>
							</select>
						</div>
						<div class="mb-3">
							<label for="output" class="form-label">Output format</label>
							<select id="output" class="form-select">
								<option value="canvas">Canvas</option>
								<option value="svg">SVG</option>
							</select>
						</div>
						<div class="mb-3">
							<label for="username" class="form-label">Username:</label>
							<div class="input-group">
								<input type="text" id="username" class="form-control" placeholder="Enter Username" />
								<img
									id="userAvatar"
									src=""
									alt="User Avatar"
									class="img-thumbnail"
									style="display: none; width: 40px; height: 40px"
								/>
							</div>
							<div id="userNotFound" class="text-danger" style="display: none">User not found</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="mb-3">
							<label for="gameSpeed" class="form-label">Game Speed:</label>
							<input type="range" class="form-range" id="gameSpeed" min="1" max="10" value="1" />
							<span id="gameSpeedValue">1</span>
						</div>
						<div class="mb-3">
							<label for="theme" class="form-label">Theme:</label>
							<select id="theme" class="form-select">
								<option value="github">GitHub</option>
								<option value="github-dark">GitHub Dark</option>
								<option value="gitlab">GitLab</option>
								<option value="gitlab-dark">GitLab Dark</option>
							</select>
						</div>
						<div class="mb-3">
							<label for="enableSounds" class="form-label">Sounds:</label>
							<select id="enableSounds" class="form-select">
								<option value="disabled">Disabled</option>
								<option value="enabled">Enabled</option>
							</select>
						</div>
					</div>
				</div>
				<button id="generate" class="btn btn-primary">Generate</button>
				<div class="alert alert-info my-2">
					<strong>Note:</strong> You might need to refresh the page after each configuration change. This is a known issue we are
					currently working on.
				</div>
			</div>

			<div class="section">
				<h2>Game Output</h2>
				<canvas id="canvas"></canvas>
				<div id="svgContainer" style="display: none">
					<img id="svgholder" />
					<br />
					<button id="downloadSvg" class="btn btn-success mt-3" style="display: none">Download SVG</button>
				</div>
			</div>

			<div class="section">
				<h2>Configuration Options</h2>
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th>Option</th>
							<th>Description</th>
							<th>Possible Values</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td><code>platform</code></td>
							<td>The platform from which to fetch contribution data</td>
							<td><code>github</code>, <code>gitlab</code></td>
						</tr>
						<tr>
							<td><code>outputFormat</code></td>
							<td>The format of the game output</td>
							<td><code>canvas</code>, <code>svg</code></td>
						</tr>
						<tr>
							<td><code>canvas</code></td>
							<td>The canvas element in DOM to render Pacman game into</td>
							<td><code>typeof HTMLCanvasElement</code></td>
						</tr>
						<tr>
							<td><code>svgCallback</code></td>
							<td>A callback function that will get called when SVG picture is generated</td>
							<td><code>(blonUrl: string) => void</code></td>
						</tr>
						<tr>
							<td><code>gameOverCallback</code></td>
							<td>A callback function that will get called when the game is over</td>
							<td><code>gameOverCallback: () => void;</code></td>
						</tr>
						<tr>
							<td><code>username</code></td>
							<td>The username of the account to fetch contributions from</td>
							<td>Any valid GitHub or GitLab username</td>
						</tr>
						<tr>
							<td><code>gameSpeed</code></td>
							<td>The speed of the Pac-Man character in the game</td>
							<td>1 (fastest) to 10 (slowest)</td>
						</tr>
						<tr>
							<td><code>gameTheme</code></td>
							<td>The visual theme of the game</td>
							<td><code>github</code>, <code>github-dark</code>, <code>gitlab</code>, <code>gitlab-dark</code></td>
						</tr>
						<tr>
							<td><code>enableSounds</code></td>
							<td>Enable or disable game sounds(only in canvas mode)</td>
							<td><code>true</code>, <code>false</code></td>
						</tr>
					</tbody>
				</table>
			</div>

			<div class="section">
				<h2>How to Use</h2>
				<h3>Method 1: NPM Package</h3>
				<pre><code>npm install pacman-contribution-graph

import { renderContributions } from 'pacman-contribution-graph';

renderContributions({
    platform: 'github',
    username: 'yourusername',
    canvas: document.getElementById('canvas'),
    outputFormat: 'canvas',
    gameTheme: 'github'
});</code></pre>

				<h3>Method 2: Script loading</h3>
				<pre><code>&lt;script type="module"&gt;
import { renderContributions } from 'https://cdn.jsdelivr.net/gh/abozanona/pacman-contribution-graph@1.0.1/dist/pacman-contribution-graph.min.js';
const canvas = document.getElementById('pacmancanvas');
const initializeGameCanvas = () =>
	renderContributions({
		platform: "gitlab",
		username: "yourusername",
		canvas: canvas,
		output: 'canvas',
		gameOverCallback: () => {
			console.log('GAME OVER');
			setTimeout(() => {
				console.log('Restarting');
				initializeGameCanvas();
			}, 3000);
		}
	});
initializeGameCanvas();
&lt;/script&gt;</code></pre>

				<h3>Method 3: Iframe/Image Embedding</h3>
				<pre>
&lt;!-- For canvas --&gt;
<code>&lt;iframe src="https://abozanona.github.io/pacman-contribution-graph/embeded/canvas.html?username=yourusername&platform=github" 
    width="800" height="600" frameborder="0"&gt;&lt;/iframe&gt;</code>
&lt;!-- For SVG --&gt;
<code>&lt;img src="https://abozanona.github.io/pacman-contribution-graph/embeded/svg.html?username=yourusername&platform=github" /&gt;</code>
</pre>
			</div>
		</div>

		<footer class="bg-light py-3 mt-5">
			<div class="container text-center">
				<div>
					<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
					<span id="busuanzi_container_site_pv">Total visits: <span id="busuanzi_value_site_pv"></span></span>
					<span class="mx-2">|</span>
					<span id="busuanzi_container_site_uv">Unique visitors: <span id="busuanzi_value_site_uv"></span></span>
				</div>
			</div>
		</footer>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
		<script type="module">
			import { renderContributions } from './dist/pacman-contribution-graph.js';

			const generateButton = document.getElementById('generate');
			const usernameInput = document.getElementById('username');
			const platformSelect = document.getElementById('platform');
			const outputSelect = document.getElementById('output');
			const gameSpeedInput = document.getElementById('gameSpeed');
			const gameSpeedValue = document.getElementById('gameSpeedValue');
			const themeSelect = document.getElementById('theme');
			const enableSoundsSelect = document.getElementById('enableSounds');
			const canvas = document.getElementById('canvas');
			const svgContainer = document.getElementById('svgContainer');
			const svgHolder = document.getElementById('svgholder');
			const downloadSvgButton = document.getElementById('downloadSvg');
			const userAvatar = document.getElementById('userAvatar');
			const userNotFound = document.getElementById('userNotFound');

			generateButton.disabled = true;

			let currentSvgBlob = null;

			gameSpeedInput.addEventListener('input', () => {
				gameSpeedValue.textContent = gameSpeedInput.value;
			});

			usernameInput.addEventListener('input', debounce(checkUser, 500));

			function debounce(func, wait) {
				let timeout;
				return function executedFunction(...args) {
					const later = () => {
						clearTimeout(timeout);
						func(...args);
					};
					clearTimeout(timeout);
					timeout = setTimeout(later, wait);
				};
			}

			async function checkUser() {
				const username = usernameInput.value;
				const platform = platformSelect.value;
				if (!username) {
					userAvatar.style.display = 'none';
					userNotFound.style.display = 'none';
					generateButton.disabled = true;
					return;
				}

				try {
					const response = await fetch(`https://api.${platform}.com/users/${username}`);
					if (response.ok) {
						const data = await response.json();
						userAvatar.src = data.avatar_url;
						userAvatar.style.display = 'inline';
						userNotFound.style.display = 'none';
						generateButton.disabled = false;
					} else {
						throw new Error('User not found');
					}
				} catch (error) {
					userAvatar.style.display = 'none';
					userNotFound.style.display = 'block';
					generateButton.disabled = true;
				}
			}

			generateButton.addEventListener('click', () => {
				const config = {
					platform: platformSelect.value,
					username: usernameInput.value,
					outputFormat: outputSelect.value,
					gameSpeed: parseInt(gameSpeedInput.value),
					gameTheme: themeSelect.value,
					enableSounds: enableSounds.value === 'enabled'
				};

				if (config.outputFormat === 'canvas') {
					canvas.style.display = 'block';
					svgContainer.style.display = 'none';
					downloadSvgButton.style.display = 'none';
					renderContributions({
						...config,
						canvas: canvas,
						gameOverCallback: () => {
							console.log('Game Over');
							setTimeout(() => renderContributions({ ...config, canvas: canvas }), 3000);
						}
					});
				} else {
					canvas.style.display = 'none';
					svgContainer.style.display = 'block';
					downloadSvgButton.style.display = 'inline-block';
					renderContributions({
						...config,
						svgCallback: (blobUrl) => {
							svgHolder.src = blobUrl;
							currentSvgBlob = blobUrl;
						},
						gameOverCallback: () => {
							console.log('Game Over');
						}
					});
				}
			});

			downloadSvgButton.addEventListener('click', () => {
				if (currentSvgBlob) {
					const link = document.createElement('a');
					link.href = currentSvgBlob;
					link.download = 'pacman-contributions.svg';
					document.body.appendChild(link);
					link.click();
					document.body.removeChild(link);
				}
			});
		</script>
	</body>
</html>
